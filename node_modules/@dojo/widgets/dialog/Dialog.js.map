{"version":3,"file":"Dialog.js","sourceRoot":"","sources":["Dialog.ts"],"names":[],"mappings":"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","sourcesContent":["import { DNode } from '@dojo/widget-core/interfaces';\nimport { WidgetBase } from '@dojo/widget-core/WidgetBase';\nimport { ThemedMixin, ThemedProperties, theme } from '@dojo/widget-core/mixins/Themed';\nimport { v } from '@dojo/widget-core/d';\nimport uuid from '@dojo/core/uuid';\nimport { Keys } from '../common/util';\n\nimport * as css from './styles/dialog.m.css';\nimport * as iconCss from '../common/styles/icons.m.css';\nimport * as animations from '../common/styles/animations.m.css';\n\n/**\n * The role of this dialog, used for accessibility\n */\nexport type RoleType = 'dialog' | 'alertdialog';\n\n/**\n * @type DialogProperties\n *\n * Properties that can be set on a Dialog component\n *\n * @property closeable          Determines whether the dialog can be closed\n * @property closeText          Hidden text used by screen readers to display for the close button\n * @property enterAnimation     CSS class to apply to the dialog when opened\n * @property exitAnimation      CSS class to apply to the dialog when closed\n * @property modal              Determines whether the dialog can be closed by clicking outside its content\n * @property onOpen             Called when the dialog opens\n * @property onRequestClose     Called when the dialog is closed\n * @property open               Determines whether the dialog is open or closed\n * @property role               Role of this dialog for accessibility, either 'alert' or 'dialog'\n * @property title              Title to show in the dialog title bar\n * @property underlay           Determines whether a semi-transparent background shows behind the dialog\n */\nexport interface DialogProperties extends ThemedProperties {\n\tcloseable?: boolean;\n\tcloseText?: string;\n\tenterAnimation?: string;\n\texitAnimation?: string;\n\tmodal?: boolean;\n\tonOpen?(): void;\n\tonRequestClose?(): void;\n\topen?: boolean;\n\trole?: RoleType;\n\ttitle?: string;\n\tunderlay?: boolean;\n};\n\nexport const DialogBase = ThemedMixin(WidgetBase);\n\n@theme(css)\n@theme(iconCss)\nexport default class Dialog extends DialogBase<DialogProperties> {\n\tprivate _titleId = uuid();\n\tprivate _wasOpen: boolean;\n\n\tprivate _onCloseClick() {\n\t\tconst {\n\t\t\tcloseable = true,\n\t\t\tonRequestClose\n\t\t} = this.properties;\n\n\t\tcloseable && onRequestClose && onRequestClose();\n\t}\n\n\tprivate _onUnderlayClick() {\n\t\t!this.properties.modal && this._onCloseClick();\n\t}\n\n\tprivate _onKeyUp = (event: KeyboardEvent) => {\n\t\tif (event.which === Keys.Escape) {\n\t\t\tthis._onCloseClick();\n\t\t}\n\t}\n\n\tconstructor() {\n\t\tsuper();\n\t\tdocument.addEventListener('keyup', this._onKeyUp);\n\t}\n\n\tprotected onDetach(): void {\n\t\tdocument.removeEventListener('keyup', this._onKeyUp);\n\t}\n\n\tprotected getContent(): DNode {\n\t\treturn v('div', {\n\t\t\tclasses: this.theme(css.content),\n\t\t\tkey: 'content'\n\t\t}, this.children);\n\t}\n\n\tprotected renderCloseIcon(): DNode {\n\t\treturn v('i', { classes: this.theme([ iconCss.icon, iconCss.closeIcon ]),\n\t\t\trole: 'presentation', 'aria-hidden': 'true'\n\t\t});\n\t}\n\n\tprotected renderTitle(): DNode {\n\t\tconst { title = '' } = this.properties;\n\t\treturn v('div', { id: this._titleId }, [ title ]);\n\t}\n\n\tprotected renderUnderlay(): DNode {\n\t\tconst { underlay } = this.properties;\n\t\treturn v('div', {\n\t\t\tclasses: [ this.theme(underlay ? css.underlayVisible : null), css.underlay ],\n\t\t\tenterAnimation: animations.fadeIn,\n\t\t\texitAnimation: animations.fadeOut,\n\t\t\tkey: 'underlay',\n\t\t\tonclick: this._onUnderlayClick\n\t\t});\n\t}\n\n\trender(): DNode {\n\t\tconst {\n\t\t\tcloseable = true,\n\t\t\tcloseText = 'close dialog',\n\t\t\tenterAnimation = animations.fadeIn,\n\t\t\texitAnimation = animations.fadeOut,\n\t\t\tonOpen,\n\t\t\topen = false,\n\t\t\trole = 'dialog'\n\t\t} = this.properties;\n\n\t\topen && !this._wasOpen && onOpen && onOpen();\n\n\t\tthis._wasOpen = open;\n\n\t\treturn v('div', {\n\t\t\tclasses: this.theme(css.root)\n\t\t}, open ? [\n\t\t\tthis.renderUnderlay(),\n\t\t\tv('div', {\n\t\t\t\t'aria-labelledby': this._titleId,\n\t\t\t\tclasses: this.theme(css.main),\n\t\t\t\tenterAnimation,\n\t\t\t\texitAnimation,\n\t\t\t\tkey: 'main',\n\t\t\t\trole\n\t\t\t}, [\n\t\t\t\tv('div', {\n\t\t\t\t\tclasses: this.theme(css.title),\n\t\t\t\t\tkey: 'title'\n\t\t\t\t}, [\n\t\t\t\t\tthis.renderTitle(),\n\t\t\t\t\tcloseable ? v('button', {\n\t\t\t\t\t\tclasses: this.theme(css.close),\n\t\t\t\t\t\tonclick: this._onCloseClick\n\t\t\t\t\t}, [\n\t\t\t\t\t\tcloseText,\n\t\t\t\t\t\tthis.renderCloseIcon()\n\t\t\t\t\t]) : null\n\t\t\t\t]),\n\t\t\t\tthis.getContent()\n\t\t\t])\n\t\t] : []);\n\t}\n}\n"]}