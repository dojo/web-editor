{"version":3,"file":"Select.js","sourceRoot":"","sources":["Select.ts"],"names":[],"mappings":"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","sourcesContent":["import { WidgetBase } from '@dojo/widget-core/WidgetBase';\nimport { diffProperty } from '@dojo/widget-core/decorators/diffProperty';\nimport { reference } from '@dojo/widget-core/diff';\nimport { DNode } from '@dojo/widget-core/interfaces';\nimport { ThemedMixin, ThemedProperties, theme } from '@dojo/widget-core/mixins/Themed';\nimport { v, w } from '@dojo/widget-core/d';\nimport uuid from '@dojo/core/uuid';\nimport { find } from '@dojo/shim/array';\nimport { Keys } from '../common/util';\nimport Label, { LabelOptions, parseLabelClasses } from '../label/Label';\nimport Listbox from '../listbox/Listbox';\nimport * as css from './styles/select.m.css';\nimport * as iconCss from '../common/styles/icons.m.css';\n\n/**\n * @type SelectProperties\n *\n * Properties that can be set on a Select component\n *\n * @property describedBy       ID of an element that provides more descriptive text\n * @property disabled          Prevents the user from interacting with the form field\n * @property invalid           Indicates the value entered in the form field is invalid\n * @property getOptionDisabled Function that accepts an option's data and index and returns a boolean\n * @property getOptionId       Function that accepts an option's data and index and returns a string id\n * @property getOptionLabel    Function that accepts an option's data and index and returns a DNode label\n * @property getOptionSelected Function that accepts an option's data and index and returns a boolean\n * @property getOptionValue    Function that accepts an option's data and index and returns a string value\n * @property label             Label settings for form label text, position, and visibility\n * @property name              The form widget's name\n * @property options           Array of any type of data for the options\n * @property placeholder       Optional placeholder text, only valid for custom select widgets (useNativeElement must be false or undefined)\n * @property readOnly          Allows or prevents user interaction\n * @property required          Whether or not a value is required\n * @property useNativeElement  Use the native <select> element if true\n * @property value             The current value\n * @property onBlur            Called when the input loses focus\n * @property onChange          Called when the node's 'change' event is fired\n * @property onFocus           Called when the input is focused\n */\nexport interface SelectProperties extends ThemedProperties {\n\tdescribedBy?: string;\n\tdisabled?: boolean;\n\tinvalid?: boolean;\n\tgetOptionDisabled?(option: any, index: number): boolean;\n\tgetOptionId?(option: any, index: number): string;\n\tgetOptionLabel?(option: any): DNode;\n\tgetOptionSelected?(option: any, index: number): boolean;\n\tgetOptionValue?(option: any, index: number): string;\n\tlabel?: string | LabelOptions;\n\tname?: string;\n\toptions?: any[];\n\tplaceholder?: string;\n\treadOnly?: boolean;\n\trequired?: boolean;\n\tuseNativeElement?: boolean;\n\tvalue?: string;\n\tonBlur?(key?: string | number): void;\n\tonChange?(option: any, key?: string | number): void;\n\tonFocus?(key?: string | number): void;\n}\n\nexport const ThemedBase = ThemedMixin(WidgetBase);\n\n@theme(css)\n@theme(iconCss)\n@diffProperty('options', reference)\nexport default class Select extends ThemedBase<SelectProperties> {\n\tprivate _callTriggerFocus = false;\n\tprivate _callListboxFocus = false;\n\tprivate _focusedIndex = 0;\n\tprivate _ignoreBlur = false;\n\tprivate _open = false;\n\tprivate _baseId = uuid();\n\n\tprivate _getOptionLabel(option: any) {\n\t\tconst { getOptionLabel } = this.properties;\n\t\tconst fallback = option ? `${option}` : '';\n\t\treturn getOptionLabel ? getOptionLabel(option) : fallback;\n\t}\n\n\tprivate _onBlur (event: FocusEvent) { this.properties.onBlur && this.properties.onBlur(this.properties.key || ''); }\n\tprivate _onFocus (event: FocusEvent) { this.properties.onFocus && this.properties.onFocus(this.properties.key || ''); }\n\n\t// native select events\n\tprivate _onNativeChange (event: Event) {\n\t\tconst {\n\t\t\tkey,\n\t\t\tgetOptionValue,\n\t\t\toptions = [],\n\t\t\tonChange\n\t\t} = this.properties;\n\t\tconst value = (<HTMLInputElement> event.target).value;\n\t\tconst option = find(options, (option: any, index: number) => getOptionValue ? getOptionValue(option, index) === value : false);\n\t\toption && onChange && onChange(option, key);\n\t}\n\n\t// custom select events\n\tprivate _openSelect() {\n\t\tthis._callListboxFocus = true;\n\t\tthis._ignoreBlur = true;\n\t\tthis._open = true;\n\t\tthis._focusedIndex = this._focusedIndex || 0;\n\t\tthis.invalidate();\n\t}\n\n\tprivate _closeSelect() {\n\t\tthis._ignoreBlur = true;\n\t\tthis._open = false;\n\t\tthis.invalidate();\n\t}\n\n\tprivate _onDropdownKeyDown(event: KeyboardEvent) {\n\t\tif (event.which === Keys.Escape) {\n\t\t\tthis._callTriggerFocus = true;\n\t\t\tthis._closeSelect();\n\t\t}\n\t}\n\n\tprivate _onTriggerClick(event: MouseEvent) {\n\t\tthis._open ? this._closeSelect() : this._openSelect();\n\t}\n\n\tprivate _onTriggerBlur(event: FocusEvent) {\n\t\tif (this._ignoreBlur) {\n\t\t\tthis._ignoreBlur = false;\n\t\t\treturn;\n\t\t}\n\n\t\tconst { key, onBlur } = this.properties;\n\t\tonBlur && onBlur(key);\n\t\tthis._closeSelect();\n\t}\n\n\tprivate _onTriggerKeyDown(event: KeyboardEvent) {\n\t\tif (event.which === Keys.Down) {\n\t\t\tthis._openSelect();\n\t\t}\n\t}\n\n\tprivate _onTriggerMouseDown() {\n\t\tthis._ignoreBlur = true;\n\t}\n\n\tprivate _onListboxBlur(event: FocusEvent) {\n\t\tif (this._ignoreBlur) {\n\t\t\tthis._ignoreBlur = false;\n\t\t\treturn;\n\t\t}\n\n\t\tconst { key, onBlur } = this.properties;\n\t\tonBlur && onBlur(key);\n\t\tthis._closeSelect();\n\t}\n\n\tprotected getModifierClasses() {\n\t\tconst {\n\t\t\tdisabled,\n\t\t\tinvalid,\n\t\t\treadOnly,\n\t\t\trequired\n\t\t} = this.properties;\n\n\t\treturn [\n\t\t\tdisabled ? css.disabled : null,\n\t\t\tinvalid ? css.invalid : null,\n\t\t\tinvalid === false ? css.valid : null,\n\t\t\treadOnly ? css.readonly : null,\n\t\t\trequired ? css.required : null\n\t\t];\n\t}\n\n\tprotected onElementUpdated(element: HTMLElement, key: string) {\n\t\tif (key === 'root' && this._callListboxFocus) {\n\t\t\tthis._callListboxFocus = false;\n\t\t\tconst listbox = <HTMLElement> element.querySelector('[role=\"listbox\"]');\n\t\t\tlistbox && listbox.focus();\n\t\t}\n\n\t\tif (key === 'trigger' && this._callTriggerFocus) {\n\t\t\tthis._callTriggerFocus = false;\n\t\t\telement.focus();\n\t\t}\n\t}\n\n\tprotected renderExpandIcon(): DNode {\n\t\treturn v('span', { classes: this.theme(css.arrow) }, [\n\t\t\tv('i', { classes: this.theme([ iconCss.icon, iconCss.downIcon ]),\n\t\t\t\trole: 'presentation', 'aria-hidden': 'true'\n\t\t\t})\n\t\t]);\n\t}\n\n\tprotected renderNativeSelect(): DNode {\n\t\tconst {\n\t\t\tdescribedBy,\n\t\t\tdisabled,\n\t\t\tgetOptionDisabled,\n\t\t\tgetOptionId,\n\t\t\tgetOptionSelected,\n\t\t\tgetOptionValue,\n\t\t\tinvalid,\n\t\t\tname,\n\t\t\toptions = [],\n\t\t\treadOnly,\n\t\t\trequired,\n\t\t\tvalue\n\t\t} = this.properties;\n\n\t\t/* create option nodes */\n\t\tconst optionNodes = options.map((option, i) => v('option', {\n\t\t\tvalue: getOptionValue ? getOptionValue(option, i) : '',\n\t\t\tid: getOptionId ? getOptionId(option, i) : undefined,\n\t\t\tdisabled: getOptionDisabled ? getOptionDisabled(option, i) : undefined,\n\t\t\tselected: getOptionSelected ? getOptionSelected(option, i) : undefined\n\t\t}, [ this._getOptionLabel(option) ]));\n\n\t\treturn v('div', { classes: this.theme(css.inputWrapper) }, [\n\t\t\tv('select', {\n\t\t\t\tclasses: this.theme(css.input),\n\t\t\t\t'aria-describedby': describedBy,\n\t\t\t\tdisabled,\n\t\t\t\t'aria-invalid': invalid ? 'true' : null,\n\t\t\t\tname,\n\t\t\t\treadOnly,\n\t\t\t\t'aria-readonly': readOnly ? 'true' : null,\n\t\t\t\trequired,\n\t\t\t\tvalue,\n\t\t\t\tonblur: this._onBlur,\n\t\t\t\tonchange: this._onNativeChange,\n\t\t\t\tonfocus: this._onFocus\n\t\t\t}, optionNodes),\n\t\t\tthis.renderExpandIcon()\n\t\t]);\n\t}\n\n\tprotected renderCustomSelect(): DNode {\n\t\tconst {\n\t\t\tdescribedBy,\n\t\t\tgetOptionDisabled,\n\t\t\tgetOptionId,\n\t\t\tgetOptionLabel,\n\t\t\tgetOptionSelected,\n\t\t\tkey,\n\t\t\toptions = [],\n\t\t\ttheme,\n\t\t\tonChange\n\t\t} = this.properties;\n\n\t\tconst {\n\t\t\t_open,\n\t\t\t_focusedIndex,\n\t\t\t_baseId\n\t\t} = this;\n\n\t\t// create dropdown trigger and select box\n\t\treturn v('div', {\n\t\t\tkey: 'root',\n\t\t\tclasses: this.theme([ css.inputWrapper, _open ? css.open : null ])\n\t\t}, [\n\t\t\t...this.renderCustomTrigger(),\n\t\t\tv('div', {\n\t\t\t\tclasses: this.theme(css.dropdown),\n\t\t\t\tonfocusout: this._onListboxBlur,\n\t\t\t\tonkeydown: this._onDropdownKeyDown\n\t\t\t}, [\n\t\t\t\tw(Listbox, {\n\t\t\t\t\tactiveIndex: _focusedIndex,\n\t\t\t\t\tdescribedBy,\n\t\t\t\t\tid: _baseId,\n\t\t\t\t\toptionData: options,\n\t\t\t\t\ttabIndex: _open ? 0 : -1,\n\t\t\t\t\tgetOptionDisabled,\n\t\t\t\t\tgetOptionId,\n\t\t\t\t\tgetOptionLabel,\n\t\t\t\t\tgetOptionSelected,\n\t\t\t\t\ttheme,\n\t\t\t\t\tonActiveIndexChange: (index: number) => {\n\t\t\t\t\t\tthis._focusedIndex = index;\n\t\t\t\t\t\tthis.invalidate();\n\t\t\t\t\t},\n\t\t\t\t\tonOptionSelect: (option: any) => {\n\t\t\t\t\t\tonChange && onChange(option, key);\n\t\t\t\t\t\tthis._callTriggerFocus = true;\n\t\t\t\t\t\tthis._closeSelect();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t])\n\t\t]);\n\t}\n\n\tprotected renderCustomTrigger(): DNode[] {\n\t\tconst {\n\t\t\tdescribedBy,\n\t\t\tdisabled,\n\t\t\tgetOptionSelected,\n\t\t\tinvalid,\n\t\t\toptions = [],\n\t\t\tplaceholder,\n\t\t\treadOnly,\n\t\t\trequired,\n\t\t\tvalue\n\t\t} = this.properties;\n\n\t\tlet label: DNode;\n\t\tlet isPlaceholder = false;\n\n\t\tconst selectedOption = find(options, (option: any, index: number) => {\n\t\t\treturn getOptionSelected ? getOptionSelected(option, index) : false;\n\t\t});\n\n\t\tif (selectedOption) {\n\t\t\tlabel = this._getOptionLabel(selectedOption);\n\t\t}\n\t\telse {\n\t\t\tisPlaceholder = true;\n\t\t\tlabel = placeholder ? placeholder : this._getOptionLabel(options[0]);\n\t\t}\n\n\t\treturn [\n\t\t\tv('button', {\n\t\t\t\t'aria-controls': this._baseId,\n\t\t\t\t'aria-expanded': `${this._open}`,\n\t\t\t\t'aria-haspopup': 'listbox',\n\t\t\t\t'aria-invalid': invalid ? 'true' : null,\n\t\t\t\t'aria-readonly': readOnly ? 'true' : null,\n\t\t\t\t'aria-required': required ? 'true' : null,\n\t\t\t\tclasses: this.theme([ css.trigger, isPlaceholder ? css.placeholder : null ]),\n\t\t\t\tdescribedBy,\n\t\t\t\tdisabled,\n\t\t\t\tkey: 'trigger',\n\t\t\t\tvalue,\n\t\t\t\tonblur: this._onTriggerBlur,\n\t\t\t\tonclick: this._onTriggerClick,\n\t\t\t\tonfocus: this._onFocus,\n\t\t\t\tonkeydown: this._onTriggerKeyDown,\n\t\t\t\tonmousedown: this._onTriggerMouseDown\n\t\t\t}, [ label ]),\n\t\t\tthis.renderExpandIcon()\n\t\t];\n\t}\n\n\tprotected render(): DNode {\n\t\tconst {\n\t\t\tlabel,\n\t\t\tuseNativeElement = false,\n\t\t\ttheme\n\t\t} = this.properties;\n\n\t\tlet rootWidget;\n\t\tconst select = useNativeElement ? this.renderNativeSelect() : this.renderCustomSelect();\n\t\tconst modifierClasses = this.getModifierClasses();\n\n\t\tif (label) {\n\t\t\trootWidget = w(Label, {\n\t\t\t\textraClasses: { root: parseLabelClasses(this.theme([ css.root, ...modifierClasses ])) },\n\t\t\t\tforId: this._baseId,\n\t\t\t\tlabel,\n\t\t\t\ttheme\n\t\t\t}, [ select ]);\n\t\t}\n\t\telse {\n\t\t\trootWidget = v('div', {\n\t\t\t\tclasses: this.theme([ css.root, ...modifierClasses ])\n\t\t\t}, [ select ]);\n\t\t}\n\n\t\treturn rootWidget;\n\t}\n}\n"]}