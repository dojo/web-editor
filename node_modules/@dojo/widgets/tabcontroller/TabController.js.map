{"version":3,"file":"TabController.js","sourceRoot":"","sources":["TabController.ts"],"names":[],"mappings":"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","sourcesContent":["import { assign } from '@dojo/core/lang';\nimport { DNode, WNode } from '@dojo/widget-core/interfaces';\nimport Tab, { TabProperties } from './Tab';\nimport { ThemedMixin, ThemedProperties, theme } from '@dojo/widget-core/mixins/Themed';\nimport { v, w } from '@dojo/widget-core/d';\nimport { WidgetBase } from '@dojo/widget-core/WidgetBase';\nimport TabButton from './TabButton';\nimport uuid from '@dojo/core/uuid';\n\nimport * as css from './styles/tabController.m.css';\n\n/**\n * Enum for tab button alignment\n */\nexport const enum Align {\n\tbottom,\n\tleft,\n\tright,\n\ttop\n};\n\n/**\n * @type TabControllerProperties\n *\n * Properties that can be set on a TabController component\n *\n * @property activeIndex           Position of the currently active tab\n * @property alignButtons          Orientation of the tab buttons\n * @property onRequestTabChange    Called when a new tab button is clicked\n * @property onRequestTabClose     Called when a tab close button is clicked\n */\nexport interface TabControllerProperties extends ThemedProperties {\n\tactiveIndex: number;\n\talignButtons?: Align;\n\tonRequestTabChange?(index: number, key: string): void;\n\tonRequestTabClose?(index: number, key: string): void;\n};\n\nexport const TabControllerBase = ThemedMixin(WidgetBase);\n\n@theme(css)\nexport default class TabController extends TabControllerBase<TabControllerProperties, WNode<Tab>> {\n\tprivate _id = uuid();\n\tprivate _callTabFocus = false;\n\n\tprivate get _tabs(): WNode<Tab>[] {\n\t\treturn this.children.filter(child => child !== null) as WNode<Tab>[];\n\t}\n\n\tprivate _onDownArrowPress() {\n\t\tconst { alignButtons } = this.properties;\n\n\t\tif (alignButtons === Align.left || alignButtons === Align.right) {\n\t\t\tthis.selectNextIndex();\n\t\t}\n\t}\n\n\tprivate _onLeftArrowPress() {\n\t\tthis.selectPreviousIndex();\n\t}\n\n\tprivate _onRightArrowPress() {\n\t\tthis.selectNextIndex();\n\t}\n\n\tprivate _onUpArrowPress() {\n\t\tconst { alignButtons } = this.properties;\n\n\t\tif (alignButtons === Align.left || alignButtons === Align.right) {\n\t\t\tthis.selectPreviousIndex();\n\t\t}\n\t}\n\n\t/**\n\t * Determines if the tab at `currentIndex` is enabled. If disabled,\n\t * returns the next valid index, or null if no enabled tabs exist.\n\t */\n\tprivate _validateIndex(currentIndex: number, backwards?: boolean) {\n\t\tconst tabs = this._tabs;\n\n\t\tif (tabs.every(result => Boolean(result.properties.disabled))) {\n\t\t\treturn null;\n\t\t}\n\n\t\tfunction nextIndex(index: number) {\n\t\t\tif (backwards) {\n\t\t\t\treturn (tabs.length + (index - 1)) % tabs.length;\n\t\t\t}\n\t\t\treturn (index + 1) % tabs.length;\n\t\t}\n\n\t\tlet i = !tabs[currentIndex] ? tabs.length - 1 : currentIndex;\n\n\t\twhile (tabs[i].properties.disabled) {\n\t\t\ti = nextIndex(i);\n\t\t}\n\n\t\treturn i;\n\t}\n\n\tprotected closeIndex(index: number) {\n\t\tconst { onRequestTabClose } = this.properties;\n\t\tconst key = this._tabs[index].properties.key;\n\t\tthis._callTabFocus = true;\n\n\t\tonRequestTabClose && onRequestTabClose(index, key);\n\t}\n\n\tprotected renderButtonContent(label?: DNode): DNode[] {\n\t\treturn [ label || null ];\n\t}\n\n\tprotected renderTabButtons(): DNode[] {\n\t\treturn this._tabs.map((tab, i) => {\n\t\t\tconst {\n\t\t\t\tcloseable,\n\t\t\t\tdisabled,\n\t\t\t\tkey,\n\t\t\t\tlabel,\n\t\t\t\ttheme = {}\n\t\t\t} = <TabProperties> tab.properties;\n\n\t\t\treturn w(TabButton, {\n\t\t\t\tcallFocus: this._callTabFocus &&  i === this.properties.activeIndex,\n\t\t\t\tactive: i === this.properties.activeIndex,\n\t\t\t\tcloseable,\n\t\t\t\tcontrols: `${ this._id }-tab-${i}`,\n\t\t\t\tdisabled,\n\t\t\t\tid: `${ this._id }-tabbutton-${i}`,\n\t\t\t\tindex: i,\n\t\t\t\tkey: `${ key }-tabbutton`,\n\t\t\t\tonClick: this.selectIndex,\n\t\t\t\tonCloseClick: this.closeIndex,\n\t\t\t\tonDownArrowPress: this._onDownArrowPress,\n\t\t\t\tonEndPress: this.selectLastIndex,\n\t\t\t\tonFocusCalled: () => { this._callTabFocus = false; },\n\t\t\t\tonHomePress: this.selectFirstIndex,\n\t\t\t\tonLeftArrowPress: this._onLeftArrowPress,\n\t\t\t\tonRightArrowPress: this._onRightArrowPress,\n\t\t\t\tonUpArrowPress: this._onUpArrowPress,\n\t\t\t\ttheme\n\t\t\t}, this.renderButtonContent(label));\n\t\t});\n\t}\n\n\tprotected renderTabs(): DNode[] {\n\t\tconst { activeIndex } = this.properties;\n\n\t\treturn this._tabs\n\t\t\t.filter((tab, i) => {\n\t\t\t\treturn i === activeIndex && tab.children.length;\n\t\t\t})\n\t\t\t.map((tab, i) => {\n\t\t\t\tassign(tab.properties, {\n\t\t\t\t\tid: `${ this._id }-tab-${i}`,\n\t\t\t\t\tlabelledBy: `${ this._id }-tabbutton-${i}`\n\t\t\t\t});\n\t\t\t\treturn tab;\n\t\t\t});\n\t}\n\n\tprotected selectFirstIndex() {\n\t\tthis.selectIndex(0, true);\n\t}\n\n\tprotected selectIndex(index: number, backwards?: boolean) {\n\t\tconst {\n\t\t\tactiveIndex,\n\t\t\tonRequestTabChange\n\t\t} = this.properties;\n\n\t\tconst validIndex = this._validateIndex(index, backwards);\n\t\tthis._callTabFocus = true;\n\n\t\tif (validIndex !== null && validIndex !== activeIndex) {\n\t\t\tconst key = this._tabs[validIndex].properties.key;\n\t\t\tonRequestTabChange && onRequestTabChange(validIndex, key);\n\t\t}\n\t}\n\n\tprotected selectLastIndex() {\n\t\tthis.selectIndex(this._tabs.length - 1);\n\t}\n\n\tprotected selectNextIndex() {\n\t\tconst { activeIndex } = this.properties;\n\n\t\tthis.selectIndex(activeIndex === this._tabs.length - 1 ? 0 : activeIndex + 1);\n\t}\n\n\tprotected selectPreviousIndex() {\n\t\tconst { activeIndex } = this.properties;\n\n\t\tthis.selectIndex(activeIndex === 0 ? this._tabs.length - 1 : activeIndex - 1, true);\n\t}\n\n\trender(): DNode {\n\t\tconst { activeIndex } = this.properties;\n\t\tconst validIndex = this._validateIndex(activeIndex);\n\t\tconst tabs = this.renderTabs();\n\n\t\tif (validIndex !== null && validIndex !== activeIndex) {\n\t\t\tthis.selectIndex(validIndex);\n\t\t\treturn null;\n\t\t}\n\n\t\tconst children = [\n\t\t\tv('div', {\n\t\t\t\tkey: 'buttons',\n\t\t\t\tclasses: this.theme(css.tabButtons)\n\t\t\t}, this.renderTabButtons()),\n\t\t\ttabs.length ? v('div', {\n\t\t\t\tkey: 'tabs',\n\t\t\t\tclasses: this.theme(css.tabs)\n\t\t\t}, tabs) : null\n\t\t];\n\n\t\tlet alignClass;\n\t\tlet orientation = 'horizontal';\n\n\t\tswitch (this.properties.alignButtons) {\n\t\t\tcase Align.right:\n\t\t\t\talignClass = css.alignRight;\n\t\t\t\torientation = 'vertical';\n\t\t\t\tchildren.reverse();\n\t\t\t\tbreak;\n\t\t\tcase Align.bottom:\n\t\t\t\talignClass = css.alignBottom;\n\t\t\t\tchildren.reverse();\n\t\t\t\tbreak;\n\t\t\tcase Align.left:\n\t\t\t\talignClass = css.alignLeft;\n\t\t\t\torientation = 'vertical';\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn v('div', {\n\t\t\t'aria-orientation': orientation,\n\t\t\tclasses: this.theme([\n\t\t\t\talignClass ? alignClass : null,\n\t\t\t\tcss.root\n\t\t\t]),\n\t\t\trole: 'tablist'\n\t\t}, children);\n\t}\n}\n"]}