{"version":3,"file":"Outlet.js","sourceRoot":"","sources":["Outlet.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n\tConstructor,\n\tRegistryLabel,\n\tDNode,\n\tWidgetBaseInterface,\n\tWidgetProperties\n} from '@dojo/widget-core/interfaces';\nimport { WidgetBase } from '@dojo/widget-core/WidgetBase';\nimport { w } from '@dojo/widget-core/d';\nimport { inject } from '@dojo/widget-core/decorators/inject';\n\nimport { Router } from './Router';\nimport { routerKey } from './RouterInjector';\nimport {\n\tMatchType,\n\tComponent,\n\tMapParams,\n\tOutletComponents,\n\tMapParamsOptions\n} from './interfaces';\n\nexport function isComponent<W extends WidgetBaseInterface>(value: any): value is Component<W> {\n\treturn Boolean(value && ((typeof value === 'string') || (typeof value === 'function') || (typeof value === 'symbol')));\n}\n\nexport type Outlet<\n\tW extends WidgetBaseInterface,\n\tF extends WidgetBaseInterface,\n\tE extends WidgetBaseInterface> = Constructor<WidgetBase<Partial<E['properties']> & Partial<W['properties']> & Partial<F['properties']> & WidgetProperties, null>>;\n\nexport function Outlet<W extends WidgetBaseInterface, F extends WidgetBaseInterface, E extends WidgetBaseInterface>(\n\toutletComponents: Component<W> | OutletComponents<W, F, E>,\n\toutlet: string | string[],\n\tmapParams: MapParams = (options: MapParamsOptions) => {},\n\tkey: RegistryLabel = routerKey\n): Outlet<W, F, E> {\n\tconst indexComponent = isComponent(outletComponents) ? undefined : outletComponents.index;\n\tconst mainComponent = isComponent(outletComponents) ? outletComponents : outletComponents.main;\n\tconst errorComponent = isComponent(outletComponents) ? undefined : outletComponents.error;\n\tfunction getProperties(this: WidgetBase, router: Router<any>, properties: any) {\n\t\treturn { router };\n\t};\n\n\t@inject({ name: routerKey, getProperties })\n\tclass OutletComponent extends WidgetBase<Partial<W['properties']> & { router: Router<any> }, null> {\n\n\t\tpublic __setProperties__(properties: Partial<W['properties']> & { router: Router<any> }): void {\n\t\t\tsuper.__setProperties__(properties);\n\t\t\tthis.invalidate();\n\t\t}\n\n\t\tprotected render(): DNode {\n\t\t\tconst { router } = this.properties;\n\t\t\tconst outletContext = router.getOutlet(outlet);\n\t\t\tif (outletContext) {\n\t\t\t\tconst { params, type, location } = outletContext;\n\t\t\t\tconst properties = { ...this.properties, ...mapParams({ params, type, location, router }) };\n\n\t\t\t\tif ((type === MatchType.INDEX || type === MatchType.ERROR) && indexComponent) {\n\t\t\t\t\treturn w(indexComponent, properties, this.children);\n\t\t\t\t}\n\t\t\t\telse if (type === MatchType.ERROR && errorComponent) {\n\t\t\t\t\treturn w(errorComponent, properties, this.children);\n\t\t\t\t}\n\t\t\t\telse if (type !== MatchType.ERROR && mainComponent) {\n\t\t\t\t\treturn w(mainComponent, properties, this.children);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t}\n\treturn OutletComponent;\n}\n\nexport default Outlet;\n"]}